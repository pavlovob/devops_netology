# Домашнее задание к занятию "3.7. Компьютерные сети, лекция 2"
# Задание 1
Список доступных интерфейсов на ПК:  
![image](https://user-images.githubusercontent.com/22905019/144993688-f4c15934-a50b-479d-80f0-cc73b5e987d3.png)
![image](https://user-images.githubusercontent.com/22905019/144993807-1cfa6343-b9b2-4629-aacd-7e0eaad300cb.png)
Команды для Linux:
~~~
ip link show
ifconfig
~~~
Для OS Windows 
~~~
ipconfig
~~~
# Задание 2
Для распознавания ближайшего сетевого соседа используется протокол LLDP (Link Layer Discovery Protocol)  
Программно релизуется пакетом lldp (в Linux):  
~~~
sudo apt install lldpd
sudo systemctl enable lldpd 
sudo systemctl start lldpd
lldpctl
~~~
В моем случае машина одинокая ):  
![image](https://user-images.githubusercontent.com/22905019/144995300-5fb02dcd-d847-46b8-8e27-1be92ad403f8.png)
# Задание 3
Для разделения L2 коммутатора на несколько виртуальных сетей используется технология VLAN (Virtual LAN). В Linux для этого используется пакет `vlan`:  
Смотрим интерфейсы. (см 1й скриншот). Используем физический интерфейс eno1. Для конфигурации используем утилиту `vconfig`:    
~~~
sudo apt install vlan
sudo vconfig add eno1 100
~~~
Появился тегированный VLAN интерфейс с тегом 100 (eno1.100):  
![image](https://user-images.githubusercontent.com/22905019/144997455-83e99569-0c4f-415c-9fcf-a11f1ef52cfd.png)  
Поднимаем и назначаем адрес:  
![image](https://user-images.githubusercontent.com/22905019/145000814-4a529c54-1b57-450d-a32a-55edca83e5ce.png)  
![image](https://user-images.githubusercontent.com/22905019/145000874-955804c9-3773-4de4-b7f6-9704c70fbe49.png)  
Теперь логический интерфейс "eno1.100" будет обрабатывать пакеты, помеченные тегом 100  
Указанная конфигурация временная и пропадет при перезагрузке ПК. Чтобы настройки были перманентными, нужно добавить конфиг в /etc/network/interfaces (или в yaml netplan в зависимости от версии ОС):  
~~~
#Interface eno1
auto eno1
iface eno1 inet static
      address 192.168.1.10
      netmask 255.255.255.0
      gateway 192.168.1.1
      dns-nameservers 8.8.8.8
#Interface eno1.100 (tagged)
auto eno1.100
iface eno1.100 inet static
      address 192.168.0.11
      netmask 255.255.255.0
~~~
# Задание 4
Для агрегации интерфейсов в Linux используется тихнология Bonding (объединение).
Подключение модуля к ядру:  
~~~
sudo modprobe bonding
~~~
Для того чтобы связать несколько интерфейсов необходимо прописать в файл конфигурации:  
~~~
sudo nano /etc/netplan/02-networkd.yaml
~~~
например такую конфигурацию (для интерфейсов eth0 и eth1):  
~~~
network: 
    renderer: networkd 
    version: 2 
    ethernets: 
        eth0:
          dhcp4: no
        eth1:
          dhcp4: no
    bonds: 
      bond0:
        dhcp4: no
        interfaces: [eth0, eth1]
        parameters:
          mode: 802.3ad
          mii-monitor-interval: 1
~~~
Проверяем конфигурцию:  
~~~
sudo netplan generate
~~~
если ошибок нет, применяем ее:  
~~~
sudo netplan apply
~~~
параметр, отвечающий за режим работы связки интерфейсов - `mode`. Доступны следующие режимы:  
mode=0 (balance-rr) - карусельное распределение фреймов по адаптерам   
mode=1 (active-backup) - активен только один физический интерфейс, остальные работают как резервные на случай отказа основного  
mode=2 (balance-xor) - объединенный интерфейс определяет, через какую физическую сетевую карту отправить пакеты, в зависимости от MAC-адресов источника и получателя.  
mode=3 (broadcast) Широковещательный режим, все пакеты отправляются через каждый интерфейс. Имеет ограниченное применение, но обеспечивает значительную отказоустойчивость.  
mode=4 (802.3ad) Особый режим объединения. Для него требуется специально настраивать коммутатор, к которому подключен объединенный интерфейс. Реализует стандарты объединения каналов IEEE и обеспечивает как увеличение пропускной способности, так и отказоустойчивость.  
mode=5 (balance-tlb) Распределение нагрузки при передаче. Входящий трафик обрабатывается в обычном режиме, а при передаче интерфейс определяется на основе данных о загруженности.  
mode=6 (balance-alb) Адаптивное распределение нагрузки. Аналогично предыдущему режиму, но с возможностью балансировать также входящую нагрузку.  
Подробная информация о работе связки:  
~~~
сat /proc/net/bonding/bond0
~~~
# Задание 5
в сети с маской /29 может быть 8 IP адресов. При этом адреса .0 и .7 будут служебными и на рабочих останется 6.  
в сети с маской /24 можно разместить: 256/8 = 32 подсети /29. Примеры:  
~~~
10.10.10.0/29
10.10.10.8/29
10.10.10.16/29
10.10.10.24/29
10.10.10.32/29
~~~
и т.д. до  
~~~
10.10.10.248/29
~~~
# Задание 6
Т.к. все адресное пространство в указанных 3х частных подстетях занято, остается только рассмотреть выделение подсетей в 4-м рекомендуемом диапазоне 100.64.0.0 — 100.127.255.255 (маска подсети 255.192.0.0 или /10) — для использования в качестве адресов для CGN (Carrier-Grade NAT).
Например:  
~~~
100.64.0.0/26  
100.64.0.64/26  
100.64.0.128/26  
100.64.0.192/26  
и т.д....  
~~~
# Задание 7
Проверка ARP таблиц:  
Linux  
~~~
arp
arp -a
arp -n
~~~
Windows  
~~~
arp -a
~~~
Сброс ARP кэша:  
Linux. Прямая очистка кэша командой arp не предусмотрена. Делается командой ip:  
~~~
sudo ip -s -s neigh flush all
~~~
Windows  
~~~
arp -d *
arp -d -a
~~~
Удаление элемента таблицы ARP кэша  
Linux  
~~~
~~~
Windows  
~~~
arp -d <IP_адрес_узла>
~~~
Для линукса есть дополнительная утилита arp-scan  

7. Как проверить ARP таблицу в Linux, Windows? Как очистить ARP кеш полностью? Как из ARP таблицы удалить только один нужный IP?
